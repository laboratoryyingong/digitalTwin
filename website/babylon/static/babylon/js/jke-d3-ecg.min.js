!function(a,b){"use strict";a.widget("jke.ecgChart",{options:{margin:{top:0,right:1,bottom:10,left:10},height:450,width:600,xMin:0,xMax:3e3,xMajorTicks:1e3,yMin:-1,yMax:1.5},_create:function(){var a=this;a.svg=b.select(a.element[0]).append("svg").attr("height",a.options.height).attr("width",a.options.width),a.options.height=a.options.height-a.options.margin.top-a.options.margin.bottom,a.options.width=a.options.width-a.options.margin.left-a.options.margin.right,a.canvas=a.svg.append("g").attr("transform","translate("+(a.options.margin.left+.5)+","+(a.options.margin.top+.5)+")"),a.canvas.call(function(b){a.background=b.append("rect").classed("jke-ecgChart-background",!0).attr("height",a.options.height).attr("width",a.options.width).attr("x",0).attr("y",0)}),a.yScale=b.scale.linear().domain([a.options.yMax,a.options.yMin]).range([0,a.options.height]),a.xScale=b.scale.linear().domain([a.options.xMin,a.options.xMax]).range([0,a.options.width]),a.yAxisGenerator=b.svg.axis().scale(a.yScale).orient("left").ticks(4).tickFormat(""),a.yAxis=a.canvas.append("g").classed("jke-ecgChart-axis-y",!0).call(a.yAxisGenerator),a.yGridGenerator=b.svg.axis().scale(a.yScale).orient("left").ticks(4).tickSize(-a.options.width).tickFormat(""),a.yGrid=a.canvas.append("g").classed("jke-ecgChart-grid-y",!0).call(a.yGridGenerator),a.xAxisGenerator=b.svg.axis().scale(a.xScale).orient("bottom").ticks(this.options.xMax/this.options.xMajorTicks).tickFormat(""),a.xAxis=a.canvas.append("g").classed("jke-ecgChart-axis-x",!0).attr("transform","translate(0,"+a.options.height+")").call(a.xAxisGenerator),a.xGridGenerator=b.svg.axis().scale(a.xScale).orient("top").ticks(this.options.xMax/this.options.xMajorTicks).tickSize(-a.options.height).tickFormat(""),a.xGrid=a.canvas.append("g").classed("jke-ecgChart-grid-x",!0).call(a.xGridGenerator),a.svg.call(function(b){a.clipMask=b.append("defs").append("svg:clipPath").attr("id","ecgChartClip").append("svt:rect").attr("x",0).attr("y",0).attr("height",a.options.height).attr("width",a.options.width)}),a.data=[],a.lineGenerator=b.svg.line().interpolate("cardinal").x(function(b){return a.xScale(b.x)}).y(function(b){return a.yScale(b.y)}),a.line=a.canvas.append("g").attr("clip-path","url(#ecgChartClip)").append("path").datum(a.data).classed("jke-ecgChart-line",!0).attr("d",a.lineGenerator)},_destroy:function(){this.element.remove("svg")},_redraw:function(){var a=this;a.line.attr("d",a.lineGenerator)},addDataPoint:function(a){var b=this,c={x:a.x%this.options.xMax,y:a.y};b.lastX&&b.lastX>c.x&&(b.data.length=0),b.lastX=c.x,b.data.push(c),this._redraw()}})}($,d3);